@model Diska.Models.ApplicationUser
@using System.Globalization
@{
    ViewData["Title"] = "الملف الشخصي";
    Layout = "_MerchantLayout";
    bool isAr = CultureInfo.CurrentCulture.Name.StartsWith("ar");
}

<style>
    .profile-card {
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: 20px;
        box-shadow: var(--shadow-sm);
        padding: 40px;
    }

    .shop-avatar {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, var(--primary-color), #4338ca);
        color: #fff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        font-weight: 800;
        box-shadow: 0 10px 20px rgba(79, 70, 229, 0.2);
    }

    .form-label {
        font-weight: 700;
        color: var(--text-muted);
        font-size: 0.9rem;
        margin-bottom: 8px;
    }

    .form-control {
        background: var(--bg-body);
        border-color: var(--border-color);
        color: var(--text-main);
        padding: 12px 15px;
        border-radius: 12px;
    }

        .form-control:focus {
            background: var(--bg-card);
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
            color: var(--text-main);
        }

        .form-control[readonly] {
            opacity: 0.7;
            cursor: not-allowed;
        }

    .section-title {
        font-size: 1.1rem;
        font-weight: 800;
        color: var(--text-main);
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid var(--border-color);
    }
</style>

<div class="row justify-content-center">
    <div class="col-lg-9">
        <div class="profile-card">

            <!-- Shop Info Header -->
            <div class="d-flex align-items-center mb-5 pb-4 border-bottom" style="border-color:var(--border-color)!important;">
                <div class="shop-avatar me-4">
                    <i class="fas fa-store"></i>
                </div>
                <div>
                    <h2 class="fw-bold mb-1" style="color:var(--text-main)">@Model.ShopName</h2>
                    <div class="d-flex align-items-center gap-2">
                        <span class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-25 px-3">
                            <i class="fas fa-check-circle me-1"></i> @(isAr ? "حساب موثق" : "Verified Account")
                        </span>
                        <span class="text-muted small">@Model.PhoneNumber</span>
                    </div>
                </div>
            </div>

            <form asp-action="UpdateProfile" method="post">

                <h5 class="section-title">@(isAr ? "البيانات الأساسية" : "Basic Information")</h5>
                <div class="row g-4 mb-5">
                    <div class="col-md-6">
                        <label class="form-label">@(isAr ? "الاسم بالكامل" : "Full Name")</label>
                        <input type="text" name="FullName" class="form-control" value="@Model.FullName" required>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">@(isAr ? "رقم الهاتف" : "Phone Number")</label>
                        <input type="text" class="form-control" value="@Model.PhoneNumber" readonly title="يرجى التواصل مع الدعم لتغيير الرقم">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">@(isAr ? "اسم المتجر" : "Shop Name")</label>
                        <input type="text" name="ShopName" class="form-control" value="@Model.ShopName" required>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">@(isAr ? "السجل التجاري" : "Commercial Register")</label>
                        <input type="text" name="CommercialRegister" class="form-control" value="@Model.CommercialRegister">
                    </div>
                </div>

                <h5 class="section-title">@(isAr ? "تغيير كلمة المرور" : "Change Password")</h5>
                <div class="alert alert-info border-0 d-flex align-items-center mb-4" style="background: rgba(14, 165, 233, 0.1); color: #0284c7;">
                    <i class="fas fa-lock me-3"></i>
                    <small>@(isAr ? "اترك الحقول فارغة إذا كنت لا ترغب بتغيير كلمة المرور." : "Leave blank if you don't want to change password.")</small>
                </div>

                <div class="row g-4 mb-4">
                    <div class="col-md-6">
                        <label class="form-label">@(isAr ? "كلمة المرور الحالية" : "Current Password")</label>
                        <input type="password" name="CurrentPassword" class="form-control" placeholder="••••••••">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">@(isAr ? "كلمة المرور الجديدة" : "New Password")</label>
                        <input type="password" name="NewPassword" class="form-control" placeholder="••••••••">
                    </div>
                </div>

                <div class="text-end pt-3">
                    <button type="submit" class="btn btn-primary px-5 py-2 rounded-pill fw-bold shadow-lg">
                        <i class="fas fa-save me-2"></i> @(isAr ? "حفظ التغييرات" : "Save Changes")
                    </button>
                </div>
            </form>

        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            

            if (successMsg) {
                Swal.fire({
                    icon: 'success',
                    title: '@(isAr ? "تم الحفظ" : "Saved")',
                    timer: 2000,
                    showConfirmButton: false,
                    position: 'top-end',
                    toast: true,
                    timerProgressBar: true
                });
            }

            if (errorMsg) {
                Swal.fire({
                    icon: 'error',
                    title: '@(isAr ? "خطأ" : "Error")',
                    confirmButtonText: '@(isAr ? "حسناً" : "OK")',
                    confirmButtonColor: '#d33'
                });
            }
        });
    </script>
}