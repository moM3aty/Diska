@model Diska.Models.Order
@using System.Globalization
@{
    bool isAr = CultureInfo.CurrentCulture.Name.StartsWith("ar");
    ViewData["Title"] = isAr ? "تفاصيل الطلب" : "Order Details";
}

<section class="section-padding">
    <div class="container">
        <div style="margin-bottom:20px;">
            <a asp-action="Index" style="color: #666; text-decoration:none;">
                <i class="fas fa-arrow-right"></i> @(isAr ? "العودة للطلبات" : "Back to Orders")
            </a>
        </div>

        <div class="merchant-form-box" style="border-top: 4px solid var(--primary);">
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #eee; padding-bottom:15px; margin-bottom:20px;">
                <h3 style="margin:0;">@(isAr ? "تفاصيل الطلب" : "Order Details") #@Model.Id</h3>
                <span style="background:#e0f2fe; padding:5px 15px; border-radius:20px; color:#0284c7; font-weight:bold;">@Model.Status</span>
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:30px;">
                <!-- Customer Info -->
                <div>
                    <h4 style="color: var(--primary); margin-bottom:10px;">@(isAr ? "بيانات العميل" : "Customer Info")</h4>
                    <p><strong>@(isAr ? "الاسم:" : "Name:")</strong> @Model.CustomerName</p>
                    <p><strong>@(isAr ? "الهاتف:" : "Phone:")</strong> <a href="tel:@Model.Phone">@Model.Phone</a></p>
                    <p><strong>@(isAr ? "العنوان:" : "Address:")</strong> @Model.Governorate, @Model.City, @Model.Address</p>
                </div>

                <!-- Order Info -->
                <div>
                    <h4 style="color: var(--primary); margin-bottom:10px;">@(isAr ? "ملخص" : "Summary")</h4>
                    <p><strong>@(isAr ? "تاريخ الطلب:" : "Date:")</strong> @Model.OrderDate.ToString("yyyy/MM/dd HH:mm")</p>
                    <p><strong>@(isAr ? "طريقة الدفع:" : "Payment:")</strong> @Model.PaymentMethod</p>
                </div>
            </div>

            <h4 style="margin-top:30px; margin-bottom:15px; border-top:1px solid #eee; padding-top:15px;">@(isAr ? "المنتجات المطلوبة (الخاصة بك)" : "Ordered Items (Yours)")</h4>

            <table class="table" style="width:100%; text-align:inherit;">
                <thead>
                    <tr style="background:#f9fafc;">
                        <th style="padding:10px;">@(isAr ? "المنتج" : "Product")</th>
                        <th style="padding:10px;">@(isAr ? "السعر" : "Price")</th>
                        <th style="padding:10px;">@(isAr ? "الكمية" : "Qty")</th>
                        <th style="padding:10px;">@(isAr ? "الإجمالي" : "Total")</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.OrderItems)
                    {
                        <tr>
                            <td style="padding:10px;">
                                @(isAr? item.Product?.Name : item.Product?.NameEn)
                            </td>
                            <td style="padding:10px;">@item.UnitPrice.ToString("N2")</td>
                            <td style="padding:10px; font-weight:bold;">@item.Quantity</td>
                            <td style="padding:10px;">@((item.UnitPrice * item.Quantity).ToString("N2"))</td>
                        </tr>
                    }
                </tbody>
            </table>

            <div style="margin-top:30px; text-align:center;">
                <p style="color:#666; font-size:0.9rem;">
                    @(isAr ? "ملاحظة: حالة الطلب الكلية يتم تحديثها بواسطة الإدارة." : "Note: Order status is updated by Admin.")
                </p>
                <button onclick="window.print()" class="btn btn-outline">@(isAr ? "طباعة إذن صرف" : "Print Packing Slip")</button>
            </div>
        </div>
    </div>
</section>