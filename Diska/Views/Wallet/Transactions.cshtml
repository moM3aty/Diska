@model IEnumerable<Diska.Models.WalletTransaction>
@using System.Globalization
@{
    bool isAr = CultureInfo.CurrentCulture.Name.StartsWith("ar");
    ViewData["Title"] = isAr ? "سجل المعاملات" : "Transactions History";
    Layout = "_Layout";
}

<style>
    /* =========================================
           PREMIUM TRANSACTIONS STYLES (Light & Dark)
           ========================================= */
    :root {
        /* Light Theme Defaults */
        --trans-bg-body: #f8fafc;
        --trans-card-bg: #ffffff;
        --trans-text-main: #0f172a;
        --trans-text-muted: #64748b;
        --trans-border: #e2e8f0;
        --trans-primary: #0F172A;
        --trans-accent: #FACC15;
        --trans-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
        --trans-hover-bg: #f8fafc;
    }

    [data-bs-theme="dark"] {
        /* Dark Theme Overrides */
        --trans-bg-body: #020617; /* Deep Dark */
        --trans-card-bg: #1e293b; /* Slate 800 */
        --trans-text-main: #f8fafc; /* Light Text */
        --trans-text-muted: #94a3b8; /* Muted Text */
        --trans-border: rgba(255, 255, 255, 0.08);
        --trans-primary: #f8fafc; /* White headings */
        --trans-accent: #FACC15; /* Gold remains */
        --trans-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        --trans-hover-bg: rgba(255, 255, 255, 0.03);
    }

    body {
        background-color: var(--trans-bg-body);
        transition: background-color 0.3s ease;
    }

    .section-padding {
        padding: 60px 0;
        min-height: 80vh;
    }

    /* Breadcrumb */
    .breadcrumb-custom {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 30px;
        font-size: 0.9rem;
        color: var(--trans-text-muted);
    }

        .breadcrumb-custom a {
            color: var(--trans-text-main);
            font-weight: 700;
            text-decoration: none;
            transition: 0.2s;
        }

            .breadcrumb-custom a:hover {
                color: var(--trans-accent);
            }

    /* Page Title */
    .page-title {
        margin: 0 0 30px;
        color: var(--trans-primary);
        font-weight: 800;
        font-size: 1.8rem;
    }

    /* Transactions Card */
    .transactions-card {
        background: var(--trans-card-bg);
        border-radius: 16px;
        border: 1px solid var(--trans-border);
        box-shadow: var(--trans-shadow);
        overflow: hidden;
    }

    /* Table Styles */
    .table-responsive {
        width: 100%;
        overflow-x: auto;
    }

    .table {
        width: 100%;
        border-collapse: collapse;
        text-align: @(isAr ? "right" : "left");
    }

        .table thead {
            background-color: var(--trans-hover-bg);
        }

        .table th {
            padding: 18px 24px;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--trans-text-muted);
            text-transform: uppercase;
            border-bottom: 1px solid var(--trans-border);
            white-space: nowrap;
        }

        .table td {
            padding: 20px 24px;
            border-bottom: 1px solid var(--trans-border);
            vertical-align: middle;
            color: var(--trans-text-main);
            transition: background-color 0.2s;
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        .table tr:hover td {
            background-color: var(--trans-hover-bg);
        }

    /* Badges */
    .badge-trans {
        padding: 6px 12px;
        border-radius: 30px;
        font-size: 0.75rem;
        font-weight: 700;
        display: inline-block;
        white-space: nowrap;
    }

    .badge-deposit {
        background: rgba(34, 197, 94, 0.1);
        color: #22c55e;
    }

    .badge-purchase {
        background: rgba(239, 68, 68, 0.1);
        color: #ef4444;
    }

    .badge-default {
        background: rgba(14, 165, 233, 0.1);
        color: #0284c7;
    }

    [data-bs-theme="dark"] .badge-deposit {
        background: rgba(34, 197, 94, 0.15);
        color: #4ade80;
    }

    [data-bs-theme="dark"] .badge-purchase {
        background: rgba(239, 68, 68, 0.15);
        color: #f87171;
    }

    [data-bs-theme="dark"] .badge-default {
        background: rgba(14, 165, 233, 0.15);
        color: #38bdf8;
    }

    /* Amount Colors */
    .amount-positive {
        color: #16a34a;
        font-weight: 700;
    }

    .amount-negative {
        color: #dc2626;
        font-weight: 700;
    }

    [data-bs-theme="dark"] .amount-positive {
        color: #4ade80;
    }

    [data-bs-theme="dark"] .amount-negative {
        color: #f87171;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 80px 20px;
        color: var(--trans-text-muted);
    }

    .empty-icon {
        font-size: 3rem;
        margin-bottom: 20px;
        opacity: 0.3;
        color: var(--trans-text-muted);
    }

    /* Animation */
    .fade-up {
        animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    }
    @@keyframes fadeUp {
        from

    {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }

    }
</style>

<section class="section-padding fade-up">
    <div class="container">

        <div class="breadcrumb-custom">
            <a asp-action="Index">@(isAr ? "المحفظة" : "My Wallet")</a>
            <span>/</span>
            <span>@(isAr ? "السجل الكامل" : "History")</span>
        </div>

        <h2 class="page-title">@(isAr ? "سجل المعاملات المالية" : "Transaction History")</h2>

        @if (!Model.Any())
        {
            <div class="transactions-card empty-state">
                <i class="fas fa-file-invoice-dollar empty-icon"></i>
                <p>@(isAr ? "لم تقم بأي عمليات مالية بعد." : "No transactions found.")</p>
            </div>
        }
        else
        {
            <div class="transactions-card">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>@(isAr ? "نوع العملية" : "Type")</th>
                                <th>@(isAr ? "التفاصيل" : "Details")</th>
                                <th>@(isAr ? "التاريخ" : "Date")</th>
                                <th style="text-align: end;">@(isAr ? "المبلغ" : "Amount")</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                bool isPositive = item.Type == "Deposit" || item.Type == "Refund";
                                <tr>
                                    <td>
                                        @if (item.Type == "Deposit")
                                        {
                                            <span class="badge-trans badge-deposit">@(isAr ? "إيداع" : "Deposit")</span>
                                        }
                                        else if (item.Type == "Purchase")
                                        {
                                            <span class="badge-trans badge-purchase">@(isAr ? "شراء" : "Purchase")</span>
                                        }
                                        else
                                        {
                                            <span class="badge-trans badge-default">@item.Type</span>
                                        }
                                    </td>
                                    <td>@item.Description</td>
                                    <td style="color:var(--trans-text-muted); font-size:0.9rem;">
                                        @item.TransactionDate.ToString("dd/MM/yyyy HH:mm")
                                    </td>
                                    <td style="text-align: end;" class="@(isPositive ? "amount-positive" : "amount-negative")" dir="ltr">
                                        @(isPositive ? "+" : "-")@item.Amount.ToString("N0")
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        }

    </div>
</section>