@model IEnumerable<Diska.Models.WalletTransaction>
@using System.Globalization
@{
    bool isAr = CultureInfo.CurrentCulture.Name.StartsWith("ar");
    ViewData["Title"] = isAr ? "المحفظة" : "My Wallet";
}

<section class="section-padding">
    <div class="container">

        <div class="breadcrumb" style="margin-bottom:20px;">
            <a asp-controller="Home" asp-action="Index">@(isAr ? "الرئيسية" : "Home")</a> /
            <span>@(isAr ? "محفظتي" : "My Wallet")</span>
        </div>

        <div style="max-width: 800px; margin: 0 auto;">

            <!-- Balance Card -->
            <div style="background: linear-gradient(135deg, var(--primary) 0%, #1e40af 100%); color: #fff; padding: 40px; border-radius: 16px; text-align: center; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                <p style="margin: 0 0 10px; opacity: 0.9; font-size: 1.1rem;">@(isAr ? "رصيدك الحالي" : "Current Balance")</p>
                <h1 style="margin: 0 0 20px; font-size: 3.5rem; font-weight: 800;">
                    @(((decimal)ViewBag.Balance).ToString("N0")) <small style="font-size: 1.5rem;">@(isAr ? "ج.م" : "EGP")</small>
                </h1>

                <div style="display: flex; gap: 15px; justify-content: center;">
                    <a asp-action="TopUp" class="btn" style="background: var(--accent); color: var(--primary); font-weight: bold; border: none; padding: 12px 30px; border-radius: 50px;">
                        <i class="fas fa-plus-circle"></i> @(isAr ? "شحن الرصيد" : "Top Up")
                    </a>
                </div>
            </div>

            <!-- Recent Transactions Header -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0; color: var(--primary);">@(isAr ? "آخر المعاملات" : "Recent Transactions")</h3>
                <a asp-action="Transactions" class="btn btn-outline small" style="border: 1px solid #ddd; color: #666; padding: 5px 15px; border-radius: 20px;">
                    @(isAr ? "عرض الكل" : "View All")
                </a>
            </div>

            <!-- Transactions List -->
            @if (!Model.Any())
            {
                <div style="text-align: center; padding: 40px; background: #fff; border: 1px solid #eee; border-radius: 12px;">
                    <p style="color: #999;">@(isAr ? "لا توجد معاملات حديثة." : "No recent transactions.")</p>
                </div>
            }
            else
            {
                <div style="background: #fff; border: 1px solid #eee; border-radius: 12px; overflow: hidden;">
                    @foreach (var item in Model)
                    {
                        bool isPositive = item.Type == "Deposit" || item.Type == "Refund";
                        <div style="padding: 15px 20px; border-bottom: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="width: 40px; height: 40px; background: @(isPositive ? "#dcfce7" : "#fee2e2"); color: @(isPositive ? "#16a34a" : "#dc2626"); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas @(isPositive ? "fa-arrow-down" : "fa-arrow-up")"></i>
                                </div>
                                <div>
                                    <h4 style="margin: 0; font-size: 1rem;">@item.Description</h4>
                                    <small style="color: #999;">@item.TransactionDate.ToString("dd MMMM yyyy, hh:mm tt")</small>
                                </div>
                            </div>
                            <div style="font-weight: bold; color: @(isPositive ? "#16a34a" : "#dc2626"); font-size: 1.1rem;">
                                @(isPositive ? "+" : "-")@item.Amount.ToString("N0")
                            </div>
                        </div>
                    }
                </div>
            }
        </div>

    </div>
</section>